This folder contains the R code for reproducing the results in the paper "Multiple testing with anytime-valid Monte-Carlo p-values" (https://arxiv.org/abs/2401.07365). In the aforementioned paper, we showed how anytime-valid Monte-Carlo p-values can be used to adapt the number of permutations to the number of rejections when multiple testing procedures are applied to potentially save computational effort. 

Files:

sequential_BH.R:         Contains the functions for applying the BH procedure (Benjamini and Hochberg, 1995) to anytime-valid permutation p-values. 

data_generator.R:        Function to perform simulations with independent test statistics 

data_generator_PRDS.R:   Function to perform simulations with PRDS test statistics

generate_sim_data.R:     Applies the functions data_generator and data_generator_PRDS to generate simulation results and saves them in the results folder (files "Plot_FDR_alphas.rda", "Plot_FDR_Ms.rda", "Plot_FDR_mus.rda", "Plot_FDR_pis.rda", "Plot_FDR_rhos.rda", "Plot_FDR_standard.rda").

plot_generator.R:        Uses the data files generated by "generate_sim_data.R" to generate all plots of the paper.

real_data_analysis.R:    Real data application based on the analysis by Henderson et al. (2023). The data is available at https://osf.io/8fsnx/ .

Results folder:          Contains the above mentioned .rda files and all plots shown in the paper.

### References
Y. Benjamini and Y. Hochberg. Controlling the false discovery rate: a practical and powerful
approach to multiple testing. Journal of the Royal Statistical Society: Series B (Methodology), 57
(1):289–300, 1995.

M. M. Henderson, M. J. Tarr, and L. Wehbe. A texture statistics encoding model
reveals hierarchical feature selectivity across human visual cortex. Journal of Neuroscience, 43
(22):4144–4161, 2023.

M. Zhang, J. Zou, and D. Tse. Adaptive Monte Carlo multiple testing via multi-armed
bandits. In International Conference on Machine Learning, pages 7512–7522. PMLR, 2019.
